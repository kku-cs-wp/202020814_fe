package kr.ac.kku.cs.wp.wsd.user.controller;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Controller;
import org.springframework.ui.Model;
import org.springframework.web.bind.annotation.*;

import kr.ac.kku.cs.wp.wsd.model.Board;
import kr.ac.kku.cs.wp.wsd.service.BoardService;

import java.util.ArrayList;
import java.util.List;

@Controller
public class BoardController {
	
	private final BoardService boardService;
	
    private List<Board> boards = new ArrayList<>();

    @Autowired
    public BoardController(BoardService boardService) { // 생성자를 통한 의존성 주입
        this.boardService = boardService;
    }

    // 게시글 목록
    @GetMapping("board")
    public String listBoards(Model model) {
        model.addAttribute("boards", boards);
        return "BoardList"; // boardList.jsp 렌더링
    }

    // 게시글 작성 폼
    @GetMapping("boards/new")
    public String showCreateForm() {
        return "BoardForm"; // boardForm.jsp 렌더링
    }

    // 게시글 추가
    @PostMapping("board")
    public String createBoard(@RequestParam("title") String title, @RequestParam("content") String content) {
        int id = boards.isEmpty() ? 1 : boards.get(boards.size() - 1).getId() + 1; // ID 생성 로직 개선
        boardService.createBoard(title,content);
        boards.add(new Board(id, title, content));
        return "redirect:/board";
    }


}
